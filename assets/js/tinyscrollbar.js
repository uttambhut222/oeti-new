!function(t){function o(o,e){function a(){return u.update(),i(),u}function n(){var t=j.toLowerCase()
x.obj.css(v,w/p.ratio),h.obj.css(v,-w),y.start=x.obj.offset()[v],p.obj.css(t,m[e.axis]),m.obj.css(t,m[e.axis]),x.obj.css(t,x[e.axis])}function i(){M?b.obj[0].ontouchstart=function(t){1===t.touches.length&&(s(t.touches[0]),t.stopPropagation())}:(x.obj.bind("mousedown",s),m.obj.bind("mouseup",r)),e.scroll&&window.addEventListener?(d[0].addEventListener("DOMMouseScroll",c,!1),d[0].addEventListener("mousewheel",c,!1)):e.scroll&&(d[0].onmousewheel=c)}function s(o){t("body").addClass("noSelect")
var e=parseInt(x.obj.css(v),10)
y.start=f?o.pageX:o.pageY,g.start="auto"==e?0:e,M?(document.ontouchmove=function(t){t.preventDefault(),r(t.touches[0])},document.ontouchend=l):(t(document).bind("mousemove",r),t(document).bind("mouseup",l),x.obj.bind("mouseup",l))}function c(o){if(h.ratio<1){var a=o||window.event,n=a.wheelDelta?a.wheelDelta/120:-a.detail/3
w-=n*e.wheel,w=Math.min(h[e.axis]-b[e.axis],Math.max(0,w)),x.obj.css(v,w/p.ratio),h.obj.css(v,-w),(e.lockscroll||w!==h[e.axis]-b[e.axis]&&0!==w)&&(a=t.event.fix(a),a.preventDefault())}}function r(t){h.ratio<1&&(e.invertscroll&&M?g.now=Math.min(m[e.axis]-x[e.axis],Math.max(0,g.start+(y.start-(f?t.pageX:t.pageY)))):g.now=Math.min(m[e.axis]-x[e.axis],Math.max(0,g.start+((f?t.pageX:t.pageY)-y.start))),w=g.now*p.ratio,h.obj.css(v,-w),x.obj.css(v,g.now))}function l(){t("body").removeClass("noSelect"),t(document).unbind("mousemove",r),t(document).unbind("mouseup",l),x.obj.unbind("mouseup",l),document.ontouchmove=document.ontouchend=null}var u=this,d=o,b={obj:t(".viewport",o)},h={obj:t(".overview",o)},p={obj:t(".scrollbar",o)},m={obj:t(".track",p.obj)},x={obj:t(".thumb",p.obj)},f="x"===e.axis,v=f?"left":"top",j=f?"Width":"Height",w=0,g={start:0,now:0},y={},M="ontouchstart"in document.documentElement
return this.update=function(t){b[e.axis]=b.obj[0]["offset"+j],h[e.axis]=h.obj[0]["scroll"+j],h.ratio=b[e.axis]/h[e.axis],p.obj.toggleClass("disable",h.ratio>=1),m[e.axis]="auto"===e.size?b[e.axis]:e.size,x[e.axis]=Math.min(m[e.axis],Math.max(0,"auto"===e.sizethumb?m[e.axis]*h.ratio:e.sizethumb)),p.ratio="auto"===e.sizethumb?h[e.axis]/m[e.axis]:(h[e.axis]-b[e.axis])/(m[e.axis]-x[e.axis]),w="relative"===t&&h.ratio<=1?Math.min(h[e.axis]-b[e.axis],Math.max(0,w)):0,w="bottom"===t&&h.ratio<=1?h[e.axis]-b[e.axis]:isNaN(parseInt(t,10))?w:parseInt(t,10),n()},a()}t.tiny=t.tiny||{},t.tiny.scrollbar={options:{axis:"y",wheel:40,scroll:!0,lockscroll:!0,size:"auto",sizethumb:"auto",invertscroll:!1}},t.fn.tinyscrollbar=function(e){var a=t.extend({},t.tiny.scrollbar.options,e)
return this.each(function(){t(this).data("tsb",new o(t(this),a))}),this},t.fn.tinyscrollbar_update=function(o){return t(this).data("tsb").update(o)}}(jQuery)
